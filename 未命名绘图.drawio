<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36" version="28.2.9" pages="4">
  <diagram name="第 1 页" id="xpKYfaUrq__tqGWD8kuW">
    <mxGraphModel dx="1248" dy="666" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="fkunmZJYkQotKhXcmcDi-27" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#D5E8D4;" parent="1" vertex="1">
          <mxGeometry x="124" y="154" width="580" height="212" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-8" value="MLA(DP4)" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="134" y="100" width="120" height="35" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-9" value="MLA(DP4)" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="279" y="100" width="120" height="35" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-10" value="MLA(DP4)" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="424" y="100" width="120" height="35" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-11" value="MLA(DP4)" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="574" y="100" width="120" height="35" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-12" value="MLA(DP4)" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="134" y="390" width="120" height="35" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-13" value="MLA(DP4)" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="279" y="390" width="120" height="35" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-14" value="MLA(DP4)" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="424" y="390" width="120" height="35" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-15" value="MLA(DP4)" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="574" y="390" width="120" height="35" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-16" value="MLP(DP2*TP2)" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="134" y="240" width="265" height="35" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-20" value="MLP(DP2*TP2)" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="424" y="240" width="265" height="35" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-23" value="AllGather(TP2)" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="134" y="170" width="265" height="35" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-24" value="AllGather(TP2)" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="424" y="170" width="265" height="35" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-25" value="ReduceScatter(TP2)" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="134" y="310" width="265" height="35" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-26" value="ReduceScatter(TP2)" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="424" y="310" width="265" height="35" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-28" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#D5E8D4;" parent="1" vertex="1">
          <mxGeometry x="124" y="450" width="580" height="212" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-29" value="MLP(DP2*TP2)" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="134" y="536" width="265" height="35" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-30" value="MLP(DP2*TP2)" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="424" y="536" width="265" height="35" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-31" value="AllGather(TP2)" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="134" y="466" width="265" height="35" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-32" value="AllGather(TP2)" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="424" y="466" width="265" height="35" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-33" value="ReduceScatter(TP2)" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="134" y="606" width="265" height="35" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-34" value="ReduceScatter(TP2)" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="424" y="606" width="265" height="35" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-35" value="MOE(EP4)" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="134" y="684" width="120" height="35" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-36" value="MOE(EP4)" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="279" y="684" width="120" height="35" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-37" value="MOE(EP4)" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="424" y="684" width="120" height="35" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-38" value="MOE(EP4)" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="574" y="684" width="120" height="35" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-39" value="ADD" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="134" y="750" width="120" height="35" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-40" value="ADD" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="279" y="750" width="120" height="35" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-41" value="ADD" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="424" y="750" width="120" height="35" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-42" value="ADD" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="574" y="750" width="120" height="35" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-50" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="fkunmZJYkQotKhXcmcDi-43" target="fkunmZJYkQotKhXcmcDi-47" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-43" value="" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="150" y="1240" width="317" height="360" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-44" value="&lt;div style=&quot;color: rgb(204, 204, 204); background-color: rgb(31, 31, 31); font-family: Menlo, Monaco, &amp;quot;Courier New&amp;quot;, monospace; line-height: 18px; white-space: pre;&quot;&gt;DeepseekV2MLAAttention&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="150" y="1240" width="170" height="30" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-49" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="fkunmZJYkQotKhXcmcDi-52" target="fkunmZJYkQotKhXcmcDi-47" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="110" y="1135" />
              <mxPoint x="110" y="1645" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-45" value="&lt;div style=&quot;color: rgb(204, 204, 204); background-color: rgb(31, 31, 31); font-family: Menlo, Monaco, &amp;quot;Courier New&amp;quot;, monospace; line-height: 18px; white-space: pre;&quot;&gt;RMSNorm&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="254" y="1180" width="83" height="30" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-46" value="&lt;div style=&quot;color: rgb(204, 204, 204); background-color: rgb(31, 31, 31); font-family: Menlo, Monaco, &amp;quot;Courier New&amp;quot;, monospace; line-height: 18px; white-space: pre;&quot;&gt;RMSNorm&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="267" y="1690" width="83" height="30" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-51" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="fkunmZJYkQotKhXcmcDi-47" target="fkunmZJYkQotKhXcmcDi-46" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-47" value="&lt;div style=&quot;color: rgb(204, 204, 204); background-color: rgb(31, 31, 31); font-family: Menlo, Monaco, &amp;quot;Courier New&amp;quot;, monospace; line-height: 18px; white-space: pre;&quot;&gt;Add&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="267" y="1630" width="83" height="30" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-53" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="fkunmZJYkQotKhXcmcDi-52" target="fkunmZJYkQotKhXcmcDi-45" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-52" value="input" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="254" y="1120" width="84" height="30" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-54" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.854;entryY=0;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="fkunmZJYkQotKhXcmcDi-45" target="fkunmZJYkQotKhXcmcDi-44" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-55" value="" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="530" y="1240" width="317" height="360" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-56" value="" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1110" y="1200" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-57" value="" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1230" y="1200" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-58" value="moe ep16" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="950" y="1360" width="230" height="30" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-61" value="" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1110" y="1169" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-62" value="" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1230" y="1169" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-63" value="" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1110" y="1138.5" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-64" value="" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1230" y="1138.5" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-65" value="" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1110" y="1107.5" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-66" value="" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1230" y="1107.5" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-67" value="" style="shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;labelPosition=left;verticalLabelPosition=middle;align=right;verticalAlign=middle;" parent="1" vertex="1">
          <mxGeometry x="1090" y="1108" width="20" height="122" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-70" value="TP8" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="1030" y="1138" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-71" value="DP2" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="1190" y="1060" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-88" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="fkunmZJYkQotKhXcmcDi-74" target="fkunmZJYkQotKhXcmcDi-76" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-74" value="attn 8TP * 2DP&lt;div&gt;o_proj allreduce(bs/2, h)-&amp;gt;(bs/2,h)&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="781" y="1950" width="195" height="60" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-75" value="moe 16EP (prefill)&lt;div&gt;&lt;b&gt;allgather (bs/2, h)-&amp;gt;(bs, h)&lt;/b&gt;&lt;/div&gt;&lt;div&gt;moe&lt;/div&gt;&lt;div&gt;&lt;b&gt;all_reduce+split (bs,h)-&amp;gt;(bs/2,h)&lt;/b&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="540" y="2070" width="195" height="60" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-76" value="mlp 8TP * 2DP&lt;div&gt;(bs/2,h)-&amp;gt;(bs/2,h)&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="781" y="2070" width="195" height="60" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-92" value="mlp 8TP * 2DP&lt;div&gt;&lt;b&gt;split (bs,h)-&amp;gt;(bs/2,h)&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;all_reduce (bs/2,h)&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;all_gather (bs/2,h)-&amp;gt;(bs,h)&lt;/b&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="1000" y="2070" width="195" height="60" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-94" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="fkunmZJYkQotKhXcmcDi-95" target="fkunmZJYkQotKhXcmcDi-92" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-95" value="attn 16TP * 1DP&lt;div&gt;allreduce(bs, h)-&amp;gt;(bs,h)&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="1000" y="1950" width="195" height="60" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-100" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="fkunmZJYkQotKhXcmcDi-98" target="fkunmZJYkQotKhXcmcDi-99" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-98" value="attn 16TP * DP&lt;div&gt;o_proj allreduce(bs, h)-&amp;gt;(bs,h)&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="320" y="1950" width="195" height="60" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-99" value="moe 16EP (prefill)&lt;div&gt;&lt;strike style=&quot;&quot;&gt;allgather (bs, h)-&amp;gt;(bs, h)&lt;/strike&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;moe&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;b style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;all_reduce (bs,h)&lt;/b&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="320" y="2070" width="195" height="60" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-106" value="&lt;div style=&quot;font-size: medium;&quot;&gt;&lt;p style=&quot;margin: 0pt; font-family: 等线; font-size: 12pt;&quot; class=&quot;p&quot;&gt;&lt;span style=&quot;font-family: sans-serif; letter-spacing: 0pt; font-size: 10.5pt; background: rgb(255, 255, 255);&quot;&gt;&lt;font face=&quot;sans-serif&quot;&gt;word_size=ep_size=attn_tp * attn_dp=mlp_tp * mlp_dp，attn_dp和mlp_dp三种关系，通信方式不相同&lt;/font&gt;&lt;/span&gt;&lt;span style=&quot;font-family: sans-serif; letter-spacing: 0pt; font-size: 10.5pt; background: rgb(255, 255, 255);&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0pt; font-family: 等线; font-size: 12pt; text-indent: 0pt;&quot; class=&quot;p&quot;&gt;&lt;span style=&quot;font-family: sans-serif; letter-spacing: 0pt; font-size: 10.5pt; background: rgb(255, 255, 255);&quot;&gt;1.&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-family: sans-serif; letter-spacing: 0pt; font-size: 10.5pt; background: rgb(255, 255, 255);&quot;&gt;&lt;font face=&quot;sans-serif&quot;&gt;attn_dp&amp;gt;mlp_dp：attn-&amp;gt;all_gather-&amp;gt;mlp-&amp;gt;reduce_scatter(attn_tp=1)，decode图模式场景，需为decode静态shape重构；当attn_tp&amp;gt;1时，reduce_scatter替换为all_reduce+split；&lt;/font&gt;&lt;/span&gt;&lt;span style=&quot;font-family: sans-serif; letter-spacing: 0pt; font-size: 10.5pt; background: rgb(255, 255, 255);&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0pt; font-family: 等线; font-size: 12pt; text-indent: 0pt;&quot; class=&quot;p&quot;&gt;&lt;span style=&quot;font-family: sans-serif; letter-spacing: 0pt; font-size: 10.5pt; background: rgb(255, 255, 255);&quot;&gt;2.&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-family: sans-serif; letter-spacing: 0pt; font-size: 10.5pt; background: rgb(255, 255, 255);&quot;&gt;&lt;font face=&quot;sans-serif&quot;&gt;attn_dp=mlp_dp：attn-&amp;gt;mlp，不需要通信，非最有性能版prefill可以采用；&lt;/font&gt;&lt;/span&gt;&lt;span style=&quot;font-family: sans-serif; letter-spacing: 0pt; font-size: 10.5pt; background: rgb(255, 255, 255);&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0pt; font-family: 等线; font-size: 12pt; text-indent: 0pt;&quot; class=&quot;p&quot;&gt;&lt;span style=&quot;font-family: sans-serif; letter-spacing: 0pt; font-size: 10.5pt; background: rgb(255, 255, 255);&quot;&gt;3.&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-family: sans-serif; letter-spacing: 0pt; font-size: 10.5pt; background: rgb(255, 255, 255);&quot;&gt;&lt;font face=&quot;sans-serif&quot;&gt;attn_dp&amp;lt;mlp_dp：attn-&amp;gt;split-&amp;gt;mlp-&amp;gt;allreduce+allgather（正交的通信域上），prefill优化版方案需要；&lt;/font&gt;&lt;/span&gt;&lt;/p&gt;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="774" y="1800" width="672" height="126" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-111" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="fkunmZJYkQotKhXcmcDi-107" target="fkunmZJYkQotKhXcmcDi-110" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-107" value="attn 8TP * 2DP&lt;div&gt;o_proj allreduce(bs/2, h)-&amp;gt;(bs/2,h)&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1220" y="1950" width="195" height="60" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-110" value="mlp 16TP&lt;div&gt;&lt;b&gt;allgather (bs/2,h)-&amp;gt;(bs,h)&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;all_reduce+split(bs, h)-&amp;gt;(bs/2, h)&lt;/b&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1220" y="2070" width="195" height="60" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-115" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="fkunmZJYkQotKhXcmcDi-114" target="fkunmZJYkQotKhXcmcDi-75" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-114" value="attn 8TP * 2DP&lt;div&gt;o_proj allreduce(bs/2, h)-&amp;gt;(bs/2,h)&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="540" y="1950" width="195" height="60" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-116" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="fkunmZJYkQotKhXcmcDi-117" target="fkunmZJYkQotKhXcmcDi-118" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-117" value="attn 16TP * DP&lt;div&gt;fia -&amp;gt; all2all (bs,h)-&amp;gt;(bs/4,h)&lt;br&gt;&lt;div&gt;&lt;div&gt;o_proj allreduce(bs, h)-&amp;gt;(bs,h)&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="96.5" y="1950" width="195" height="60" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-118" value="moe 16EP (prefill)&lt;div&gt;&lt;strike style=&quot;&quot;&gt;allgather (bs, h)-&amp;gt;(bs, h)&lt;/strike&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;moe&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;b style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;all_reduce (bs,h)&lt;/b&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="96.5" y="2070" width="195" height="60" as="geometry" />
        </mxCell>
        <mxCell id="fkunmZJYkQotKhXcmcDi-120" value="&lt;div style=&quot;&quot;&gt;&lt;p style=&quot;font-size: 12pt; margin: 0pt; font-family: 等线;&quot; class=&quot;p&quot;&gt;&lt;span style=&quot;font-family: sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);&quot;&gt;1. prefill mlp与moe前面的allgather合并，且需要与pd分离场景decode区分开；&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;font-size: 12pt; margin: 0pt; font-family: 等线;&quot; class=&quot;p&quot;&gt;&lt;span style=&quot;font-family: sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);&quot;&gt;2. pd混部时，moe、mlp可能都有allgather，通信有重复；pd分离时，moe无allgather，不需要考虑该问题；&lt;/span&gt;&lt;/p&gt;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="90" y="1820" width="590" height="126" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-1" value="mla prolog" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="147" y="2420" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-2" value="fa+o_project" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="325" y="2420" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-17" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" edge="1" parent="1" source="-Qro2dlxo0qdD6NKArDu-3" target="-Qro2dlxo0qdD6NKArDu-7">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-18" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;" edge="1" parent="1" source="-Qro2dlxo0qdD6NKArDu-3" target="-Qro2dlxo0qdD6NKArDu-8">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-3" value="kv_a:6144,576&amp;nbsp; 6.75M" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="314.75" y="3162" width="160" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-13" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" edge="1" parent="1" source="-Qro2dlxo0qdD6NKArDu-5" target="-Qro2dlxo0qdD6NKArDu-9">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-5" value="q_a: 6144,1536 18M" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="133.25" y="3162" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-7" value="bs,512" style="shape=parallelogram;perimeter=parallelogramPerimeter;whiteSpace=wrap;html=1;fixedSize=1;" vertex="1" parent="1">
          <mxGeometry x="312.25" y="3092" width="111" height="27" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-26" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;" edge="1" parent="1" source="-Qro2dlxo0qdD6NKArDu-8">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="453.25" y="2932" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-8" value="bs,64" style="shape=parallelogram;perimeter=parallelogramPerimeter;whiteSpace=wrap;html=1;fixedSize=1;" vertex="1" parent="1">
          <mxGeometry x="423.25" y="3092" width="61" height="27" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-14" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" edge="1" parent="1" source="-Qro2dlxo0qdD6NKArDu-9" target="-Qro2dlxo0qdD6NKArDu-10">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="193.25" y="3072" />
              <mxPoint x="169.25" y="3072" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-15" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;" edge="1" parent="1" source="-Qro2dlxo0qdD6NKArDu-9" target="-Qro2dlxo0qdD6NKArDu-11">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="193.25" y="3072" />
              <mxPoint x="255.25" y="3072" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-9" value="q_b: 1536,64*192 36M" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="128.25" y="3090.5" width="130" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-16" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" edge="1" parent="1" source="-Qro2dlxo0qdD6NKArDu-10" target="-Qro2dlxo0qdD6NKArDu-12">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="169.25" y="3002" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-10" value="bs,128" style="shape=parallelogram;perimeter=parallelogramPerimeter;whiteSpace=wrap;html=1;fixedSize=1;" vertex="1" parent="1">
          <mxGeometry x="113.25" y="3032" width="111" height="27" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-25" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.385;entryY=1.1;entryDx=0;entryDy=0;entryPerimeter=0;" edge="1" parent="1" source="-Qro2dlxo0qdD6NKArDu-11" target="-Qro2dlxo0qdD6NKArDu-19">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="260" y="2932" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-11" value="bs,64,64" style="shape=parallelogram;perimeter=parallelogramPerimeter;whiteSpace=wrap;html=1;fixedSize=1;" vertex="1" parent="1">
          <mxGeometry x="224.25" y="3032" width="61" height="27" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-12" value="W_UK: 512,64*128 8M" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="98.75" y="2972" width="140" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-28" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" edge="1" parent="1" source="-Qro2dlxo0qdD6NKArDu-19" target="-Qro2dlxo0qdD6NKArDu-27">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-19" value="ifa" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="104.25" y="2890" width="389" height="40" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-23" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.679;entryY=0.975;entryDx=0;entryDy=0;entryPerimeter=0;" edge="1" parent="1" source="-Qro2dlxo0qdD6NKArDu-7" target="-Qro2dlxo0qdD6NKArDu-19">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-24" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.167;entryY=0.975;entryDx=0;entryDy=0;entryPerimeter=0;" edge="1" parent="1" source="-Qro2dlxo0qdD6NKArDu-12" target="-Qro2dlxo0qdD6NKArDu-19">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-27" value="W_UV:6144,576&amp;nbsp; 6.75M" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="218.75" y="2820" width="160" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-29" value="" style="endArrow=classic;html=1;rounded=0;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="670" y="2820" as="sourcePoint" />
            <mxPoint x="1210" y="2820" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-43" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.25;exitY=1;exitDx=0;exitDy=0;entryX=0.25;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="-Qro2dlxo0qdD6NKArDu-32" target="-Qro2dlxo0qdD6NKArDu-37">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-32" value="run_batch" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="714" y="2796" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-33" value="" style="endArrow=classic;html=1;rounded=0;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="670" y="2890" as="sourcePoint" />
            <mxPoint x="1210" y="2890" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-36" value="" style="endArrow=classic;html=1;rounded=0;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="670" y="2960" as="sourcePoint" />
            <mxPoint x="1210" y="2960" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-42" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.25;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="-Qro2dlxo0qdD6NKArDu-37" target="-Qro2dlxo0qdD6NKArDu-41">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-37" value="in_queue" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="740" y="2867" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-47" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;" edge="1" parent="1" source="-Qro2dlxo0qdD6NKArDu-38" target="-Qro2dlxo0qdD6NKArDu-45">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-38" value="copy_done" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="580" y="2923" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-48" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;" edge="1" parent="1" source="-Qro2dlxo0qdD6NKArDu-41" target="-Qro2dlxo0qdD6NKArDu-58">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-61" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="-Qro2dlxo0qdD6NKArDu-41" target="-Qro2dlxo0qdD6NKArDu-46">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-41" value="launch_done" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="790" y="2923" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-44" value="launch_done" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="880" y="2800" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-45" value="copy_done" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="950" y="2800" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-46" value="copy_done" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="877" y="2923" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-57" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.25;exitY=1;exitDx=0;exitDy=0;entryX=0.25;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="-Qro2dlxo0qdD6NKArDu-49" target="-Qro2dlxo0qdD6NKArDu-51">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-49" value="run_batch" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1049" y="2800" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-50" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.25;entryY=0;entryDx=0;entryDy=0;" edge="1" source="-Qro2dlxo0qdD6NKArDu-51" target="-Qro2dlxo0qdD6NKArDu-55" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-51" value="in_queue" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1086" y="2867" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-52" value="copy_done" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1050" y="2923" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-55" value="launch_done" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1136" y="2923" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-56" value="copy_done" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1223" y="2923" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-59" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;" edge="1" parent="1" source="-Qro2dlxo0qdD6NKArDu-58" target="-Qro2dlxo0qdD6NKArDu-44">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-58" value="out&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;_queue&lt;/span&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="840" y="2867" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-90" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.25;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" edge="1" parent="1" source="-Qro2dlxo0qdD6NKArDu-75" target="-Qro2dlxo0qdD6NKArDu-81">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-75" value="launch1" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="530" y="3570" width="50" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-88" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="-Qro2dlxo0qdD6NKArDu-76" target="-Qro2dlxo0qdD6NKArDu-75">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-76" value="run_batch1" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="447" y="3460" width="80" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-78" value="result0" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="821" y="3460" width="50" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-100" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="-Qro2dlxo0qdD6NKArDu-79" target="-Qro2dlxo0qdD6NKArDu-96">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-79" value="run_batch2" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="875" y="3460" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-81" value="launch1_done" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="666" y="3460" width="80" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-82" value="copy0_done" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="750" y="3460" width="67" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-84" value="model run1" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="664" y="3650" width="347" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-86" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.25;entryY=1;entryDx=0;entryDy=0;" edge="1" parent="1" source="-Qro2dlxo0qdD6NKArDu-85" target="-Qro2dlxo0qdD6NKArDu-94">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1099.5" y="3600" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-109" value="synchronize" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="-Qro2dlxo0qdD6NKArDu-86">
          <mxGeometry x="0.1944" y="-1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-85" value="copy1" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="1015" y="3650" width="43" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-92" value="result1" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="1229.5" y="3460" width="80" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-93" value="launch2_done" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="1062" y="3460" width="80" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-94" value="copy1_done" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="1146" y="3460" width="80" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-101" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="-Qro2dlxo0qdD6NKArDu-96" target="-Qro2dlxo0qdD6NKArDu-103">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1080" y="3665" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-105" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.25;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" edge="1" parent="1" source="-Qro2dlxo0qdD6NKArDu-96" target="-Qro2dlxo0qdD6NKArDu-93">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-96" value="launch2" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="939" y="3570" width="50" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-103" value="model run2" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="1062" y="3650" width="347" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-108" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0;entryY=0.25;entryDx=0;entryDy=0;" edge="1" parent="1" source="-Qro2dlxo0qdD6NKArDu-107" target="-Qro2dlxo0qdD6NKArDu-85">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-107" value="copy1" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="584" y="3570" width="43" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-112" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0;entryY=0.25;entryDx=0;entryDy=0;" edge="1" parent="1" target="-Qro2dlxo0qdD6NKArDu-111">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1009.5" y="3600" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-110" value="copy2" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="994" y="3570" width="43" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-111" value="copy2" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="1413" y="3650" width="43" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-114" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;" edge="1" parent="1" source="-Qro2dlxo0qdD6NKArDu-113" target="-Qro2dlxo0qdD6NKArDu-82">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-115" value="synchronize" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="-Qro2dlxo0qdD6NKArDu-114">
          <mxGeometry x="-0.0099" y="-5" relative="1" as="geometry">
            <mxPoint x="9" y="-24" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-113" value="copy0" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="616.5" y="3650" width="43" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-116" value="model run2" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="265.25" y="3650" width="347" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-89" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0;entryY=0.25;entryDx=0;entryDy=0;shadow=0;" edge="1" parent="1" source="-Qro2dlxo0qdD6NKArDu-75" target="-Qro2dlxo0qdD6NKArDu-84">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-119" value="hidden = [bs, 6144]&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;combine&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1090" y="2250" width="352" height="180" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-120" value="moe" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="646" y="2340" width="120" height="70" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-121" value="zero" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="646" y="2420" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-122" value="moe" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="646" y="2530" width="120" height="70" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-123" value="zero" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="646" y="2610" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-124" value="moe" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="840" y="2340" width="120" height="220" as="geometry" />
        </mxCell>
        <mxCell id="-Qro2dlxo0qdD6NKArDu-125" value="zero" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="840" y="2561" width="120" height="69" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="rWovGKFSYQec_-FrO6rs" name="rs-&gt;allr">
    <mxGraphModel grid="1" page="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="CEzwtwoairZ9DkVLgezv-1" value="" style="rounded=0;whiteSpace=wrap;html=1;shadow=0;" vertex="1" parent="1">
          <mxGeometry x="130" y="507" width="300" height="483" as="geometry" />
        </mxCell>
        <mxCell id="CEzwtwoairZ9DkVLgezv-2" value="" style="rounded=0;whiteSpace=wrap;html=1;shadow=0;" vertex="1" parent="1">
          <mxGeometry x="130" y="50" width="300" height="455" as="geometry" />
        </mxCell>
        <mxCell id="w_x9INpiLtylVAHXhSTc-2" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="CEzwtwoairZ9DkVLgezv-4" target="w_x9INpiLtylVAHXhSTc-1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="CEzwtwoairZ9DkVLgezv-4" value="prolog+fa&lt;div&gt;(8,6144)&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="270" y="110" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="CEzwtwoairZ9DkVLgezv-5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="CEzwtwoairZ9DkVLgezv-7" target="CEzwtwoairZ9DkVLgezv-11">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="CEzwtwoairZ9DkVLgezv-6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;dashed=1;" edge="1" parent="1" source="CEzwtwoairZ9DkVLgezv-7" target="CEzwtwoairZ9DkVLgezv-13">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="CEzwtwoairZ9DkVLgezv-7" value="o_proj&lt;div&gt;(64,6144)&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="270" y="210" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="CEzwtwoairZ9DkVLgezv-8" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="CEzwtwoairZ9DkVLgezv-22" target="CEzwtwoairZ9DkVLgezv-18">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="CEzwtwoairZ9DkVLgezv-9" value="slice2" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="CEzwtwoairZ9DkVLgezv-8">
          <mxGeometry x="0.0545" y="2" relative="1" as="geometry">
            <mxPoint x="-28" y="-42" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="CEzwtwoairZ9DkVLgezv-10" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="CEzwtwoairZ9DkVLgezv-11" target="CEzwtwoairZ9DkVLgezv-22">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="CEzwtwoairZ9DkVLgezv-11" value="all_reduce&lt;div&gt;(64,6144)&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;" vertex="1" parent="1">
          <mxGeometry x="270" y="260" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="CEzwtwoairZ9DkVLgezv-12" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="CEzwtwoairZ9DkVLgezv-13" target="CEzwtwoairZ9DkVLgezv-22">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="CEzwtwoairZ9DkVLgezv-13" value="all_gather&lt;div&gt;(64,6144)&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;" vertex="1" parent="1">
          <mxGeometry x="140" y="210" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="CEzwtwoairZ9DkVLgezv-14" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="CEzwtwoairZ9DkVLgezv-16" target="CEzwtwoairZ9DkVLgezv-4">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="CEzwtwoairZ9DkVLgezv-15" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" edge="1" parent="1" source="CEzwtwoairZ9DkVLgezv-16" target="CEzwtwoairZ9DkVLgezv-13">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="320" y="100" />
              <mxPoint x="190" y="100" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="CEzwtwoairZ9DkVLgezv-16" value="(8,6144)" style="shape=parallelogram;perimeter=parallelogramPerimeter;whiteSpace=wrap;html=1;fixedSize=1;" vertex="1" parent="1">
          <mxGeometry x="260" y="59" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="CEzwtwoairZ9DkVLgezv-17" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="CEzwtwoairZ9DkVLgezv-18" target="CEzwtwoairZ9DkVLgezv-47">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="CEzwtwoairZ9DkVLgezv-18" value="moe&lt;div&gt;(8,6144)&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="450" y="520" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="CEzwtwoairZ9DkVLgezv-19" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="CEzwtwoairZ9DkVLgezv-22" target="CEzwtwoairZ9DkVLgezv-24">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="CEzwtwoairZ9DkVLgezv-20" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="CEzwtwoairZ9DkVLgezv-22" target="CEzwtwoairZ9DkVLgezv-40">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="320" y="350" />
              <mxPoint x="250" y="350" />
              <mxPoint x="250" y="485" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="CEzwtwoairZ9DkVLgezv-21" value="slice1" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="CEzwtwoairZ9DkVLgezv-20">
          <mxGeometry x="-0.5729" y="-1" relative="1" as="geometry">
            <mxPoint x="-30" y="61" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="CEzwtwoairZ9DkVLgezv-22" value="&lt;div&gt;add&lt;/div&gt;&lt;div&gt;(64,6144)&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="270" y="310" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="CEzwtwoairZ9DkVLgezv-23" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="CEzwtwoairZ9DkVLgezv-24" target="CEzwtwoairZ9DkVLgezv-26">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="320" y="440" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="CEzwtwoairZ9DkVLgezv-24" value="mlp&lt;br&gt;&lt;div&gt;(64,6144)&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="270" y="365" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="CEzwtwoairZ9DkVLgezv-25" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="CEzwtwoairZ9DkVLgezv-26" target="CEzwtwoairZ9DkVLgezv-40">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="CEzwtwoairZ9DkVLgezv-26" value="reduce_scatter&lt;br&gt;&lt;div&gt;(8,6144)&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="270" y="420" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="w_x9INpiLtylVAHXhSTc-6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="CEzwtwoairZ9DkVLgezv-28" target="w_x9INpiLtylVAHXhSTc-5">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="CEzwtwoairZ9DkVLgezv-28" value="prolog+fa&lt;div&gt;(8,6144)&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="270" y="520" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="CEzwtwoairZ9DkVLgezv-29" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="CEzwtwoairZ9DkVLgezv-31" target="CEzwtwoairZ9DkVLgezv-33">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="CEzwtwoairZ9DkVLgezv-30" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;dashed=1;" edge="1" parent="1" source="CEzwtwoairZ9DkVLgezv-31" target="CEzwtwoairZ9DkVLgezv-49">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="CEzwtwoairZ9DkVLgezv-31" value="o_proj&lt;div&gt;(64,6144)&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="270" y="630" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="CEzwtwoairZ9DkVLgezv-32" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="CEzwtwoairZ9DkVLgezv-33" target="CEzwtwoairZ9DkVLgezv-37">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="CEzwtwoairZ9DkVLgezv-33" value="all_reduce&lt;div&gt;(64,6144)&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;" vertex="1" parent="1">
          <mxGeometry x="270" y="680" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="CEzwtwoairZ9DkVLgezv-34" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="CEzwtwoairZ9DkVLgezv-37" target="CEzwtwoairZ9DkVLgezv-42">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="CEzwtwoairZ9DkVLgezv-35" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="CEzwtwoairZ9DkVLgezv-37" target="CEzwtwoairZ9DkVLgezv-46">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="320" y="770" />
              <mxPoint x="250" y="770" />
              <mxPoint x="250" y="900" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="CEzwtwoairZ9DkVLgezv-36" value="slice" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="CEzwtwoairZ9DkVLgezv-35">
          <mxGeometry x="-0.4966" y="1" relative="1" as="geometry">
            <mxPoint x="-22" y="59" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="CEzwtwoairZ9DkVLgezv-37" value="&lt;div&gt;add&lt;/div&gt;&lt;div&gt;(64,6144)&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="270" y="730" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="CEzwtwoairZ9DkVLgezv-38" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="CEzwtwoairZ9DkVLgezv-40" target="CEzwtwoairZ9DkVLgezv-28">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="CEzwtwoairZ9DkVLgezv-39" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="CEzwtwoairZ9DkVLgezv-40" target="CEzwtwoairZ9DkVLgezv-49">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="320" y="510" />
              <mxPoint x="190" y="510" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="CEzwtwoairZ9DkVLgezv-40" value="&lt;div&gt;add&lt;/div&gt;&lt;div&gt;(8,6144)&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="270" y="470" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="CEzwtwoairZ9DkVLgezv-41" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="CEzwtwoairZ9DkVLgezv-42" target="CEzwtwoairZ9DkVLgezv-44">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="CEzwtwoairZ9DkVLgezv-42" value="mlp&lt;br&gt;&lt;div&gt;(64,6144)&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="270" y="790" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="CEzwtwoairZ9DkVLgezv-43" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="CEzwtwoairZ9DkVLgezv-44" target="CEzwtwoairZ9DkVLgezv-46">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="CEzwtwoairZ9DkVLgezv-44" value="reduce_scatter&lt;br&gt;&lt;div&gt;(8,6144)&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="270" y="835" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="CEzwtwoairZ9DkVLgezv-45" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="CEzwtwoairZ9DkVLgezv-46" target="CEzwtwoairZ9DkVLgezv-47">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="CEzwtwoairZ9DkVLgezv-46" value="&lt;div&gt;add&lt;/div&gt;&lt;div&gt;(8,6144)&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="270" y="885" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="CEzwtwoairZ9DkVLgezv-47" value="&lt;div&gt;add&lt;/div&gt;&lt;div&gt;(8,6144)&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="270" y="930" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="CEzwtwoairZ9DkVLgezv-48" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="CEzwtwoairZ9DkVLgezv-49" target="CEzwtwoairZ9DkVLgezv-37">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="CEzwtwoairZ9DkVLgezv-49" value="all_gather&lt;div&gt;(64,6144)&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;" vertex="1" parent="1">
          <mxGeometry x="140" y="630" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="CEzwtwoairZ9DkVLgezv-50" value="rs(19us)+ag(19us)-&amp;gt;ar(27us)" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="380" y="260" width="160" height="30" as="geometry" />
        </mxCell>
        <mxCell id="w_x9INpiLtylVAHXhSTc-4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="w_x9INpiLtylVAHXhSTc-1" target="CEzwtwoairZ9DkVLgezv-7">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="w_x9INpiLtylVAHXhSTc-1" value="all2all&lt;div&gt;(64,6144)&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;" vertex="1" parent="1">
          <mxGeometry x="270" y="160" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="w_x9INpiLtylVAHXhSTc-7" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="w_x9INpiLtylVAHXhSTc-5" target="CEzwtwoairZ9DkVLgezv-31">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="w_x9INpiLtylVAHXhSTc-5" value="all2all&lt;div&gt;(64,6144)&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;" vertex="1" parent="1">
          <mxGeometry x="270" y="574" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="w_x9INpiLtylVAHXhSTc-8" value="ag(19us)" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="130" y="180" width="70" height="30" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="eckeGeMPArqBpTtbHa7v" name="第 3 页">
    <mxGraphModel grid="1" page="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="tH-RpMdc12XLNoG5fs99-2" value="" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="90" y="30" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-3" value="" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="110" y="30" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-4" value="" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="130" y="30" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-5" value="" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="150" y="30" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-11" value="···" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="170" y="40" width="20" height="19" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-17" value="" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="90" y="50" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-18" value="" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="110" y="50" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-19" value="" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="130" y="50" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-20" value="" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="150" y="50" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-21" value="···" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="110" y="70" width="20" height="19" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-22" value="" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="90" y="93" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-23" value="" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="110" y="93" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-24" value="" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="130" y="93" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-25" value="" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="150" y="93" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-26" value="···" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="170" y="103" width="20" height="19" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-27" value="" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="90" y="113" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-28" value="" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="110" y="113" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-29" value="" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="130" y="113" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-30" value="" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="150" y="113" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-31" value="···" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="110" y="133" width="20" height="19" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-32" value="" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="90" y="153" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-33" value="" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="110" y="153" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-34" value="" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="130" y="153" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-35" value="" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="150" y="153" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-36" value="···" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="170" y="163" width="20" height="19" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-37" value="" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="90" y="173" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-38" value="" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="110" y="173" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-39" value="" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="130" y="173" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-40" value="" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="150" y="173" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-41" value="···" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="110" y="193" width="20" height="19" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-61" value="" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="90" y="230" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-62" value="" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="110" y="230" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-63" value="" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="130" y="230" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-64" value="" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="150" y="230" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-65" value="···" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="170" y="240" width="20" height="19" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-66" value="" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="90" y="250" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-67" value="" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="110" y="250" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-68" value="" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="130" y="250" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-69" value="" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="150" y="250" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-70" value="···" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="110" y="270" width="20" height="19" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-71" value="" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#60a917;strokeColor=#2D7600;fontColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="90" y="293" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-72" value="" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#60a917;strokeColor=#2D7600;fontColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="110" y="293" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-73" value="" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#60a917;strokeColor=#2D7600;fontColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="130" y="293" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-74" value="" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#60a917;strokeColor=#2D7600;fontColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="150" y="293" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-75" value="···" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="170" y="303" width="20" height="19" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-76" value="" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#60a917;strokeColor=#2D7600;fontColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="90" y="313" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-77" value="" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#60a917;strokeColor=#2D7600;fontColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="110" y="313" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-78" value="" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#60a917;strokeColor=#2D7600;fontColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="130" y="313" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-79" value="" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#60a917;strokeColor=#2D7600;fontColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="150" y="313" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-80" value="···" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="110" y="333" width="20" height="19" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-81" value="···" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="110" y="200" width="20" height="19" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-82" value="···" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="110" y="205" width="20" height="19" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-83" value="" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="310" y="30" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-84" value="" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="330" y="30" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-85" value="" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="350" y="30" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-106" value="" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#1ba1e2;strokeColor=#006EAF;fontColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="90" y="360" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-107" value="" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#1ba1e2;strokeColor=#006EAF;fontColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="110" y="360" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-108" value="" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#1ba1e2;strokeColor=#006EAF;fontColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="130" y="360" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-109" value="" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#1ba1e2;strokeColor=#006EAF;fontColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="150" y="360" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-110" value="···" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="170" y="370" width="20" height="19" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-111" value="" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#1ba1e2;strokeColor=#006EAF;fontColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="90" y="380" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-112" value="" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#1ba1e2;strokeColor=#006EAF;fontColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="110" y="380" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-113" value="" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#1ba1e2;strokeColor=#006EAF;fontColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="130" y="380" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-114" value="" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#1ba1e2;strokeColor=#006EAF;fontColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="150" y="380" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-115" value="···" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="110" y="400" width="20" height="19" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-116" value="EP0" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="40" y="34.5" width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-117" value="EP1" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="40" y="97.5" width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-118" value="EP2" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="40" y="157.5" width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-119" value="EP3" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="40" y="234.5" width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-120" value="EP4" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="40" y="297.5" width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-121" value="EP5" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="40" y="364.5" width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-123" value="" style="shape=singleArrow;whiteSpace=wrap;html=1;arrowWidth=0.4828828828828847;arrowSize=0.45378378378378414;" vertex="1" parent="1">
          <mxGeometry x="210" y="157.5" width="50" height="31" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-125" value="" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="310" y="50" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-126" value="" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="330" y="50" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-132" value="" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="310" y="93" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-137" value="" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="370" y="30" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-138" value="" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="350" y="50" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tH-RpMdc12XLNoG5fs99-139" value="" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="330" y="93" width="20" height="20" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="8vk4PVjKcTbukSkfql9D" name="attn tp8">
    <mxGraphModel dx="1949" dy="672" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-21" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="pP14fSGPa2KV1FeZhE6j-2" target="qxU7TaMwEPtlLGnzDzlK-2">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="pP14fSGPa2KV1FeZhE6j-2" value="attn tp16" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#1ba1e2;fontColor=#ffffff;strokeColor=#006EAF;" vertex="1" parent="1">
          <mxGeometry x="130" y="299" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-19" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="qxU7TaMwEPtlLGnzDzlK-1" target="qxU7TaMwEPtlLGnzDzlK-7">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-1" value="reduce_scatter" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="130" y="410" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-20" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" edge="1" parent="1" source="qxU7TaMwEPtlLGnzDzlK-2" target="qxU7TaMwEPtlLGnzDzlK-1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-2" value="o_proj" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#1ba1e2;fontColor=#ffffff;strokeColor=#006EAF;" vertex="1" parent="1">
          <mxGeometry x="130" y="350" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-18" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="qxU7TaMwEPtlLGnzDzlK-7" target="qxU7TaMwEPtlLGnzDzlK-8">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-7" value="add/rms norm&lt;div&gt;dynamic quant&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#60a917;fontColor=#ffffff;strokeColor=#2D7600;" vertex="1" parent="1">
          <mxGeometry x="130" y="468" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-16" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="qxU7TaMwEPtlLGnzDzlK-8" target="qxU7TaMwEPtlLGnzDzlK-9">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-17" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="qxU7TaMwEPtlLGnzDzlK-8" target="qxU7TaMwEPtlLGnzDzlK-10">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-8" value="all gather" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="130" y="527" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-13" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="qxU7TaMwEPtlLGnzDzlK-9" target="qxU7TaMwEPtlLGnzDzlK-12">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-9" value="mlp/attn/mlp tp16" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#1ba1e2;fontColor=#ffffff;strokeColor=#006EAF;" vertex="1" parent="1">
          <mxGeometry x="70" y="599" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-14" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="qxU7TaMwEPtlLGnzDzlK-10" target="qxU7TaMwEPtlLGnzDzlK-12">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="180" y="679" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-10" value="moe ep16" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="190" y="599" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-27" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="qxU7TaMwEPtlLGnzDzlK-11" target="qxU7TaMwEPtlLGnzDzlK-26">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-11" value="reduce_scatter" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="130" y="720" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-15" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" edge="1" parent="1" source="qxU7TaMwEPtlLGnzDzlK-12" target="qxU7TaMwEPtlLGnzDzlK-11">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-12" value="add" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#1ba1e2;fontColor=#ffffff;strokeColor=#006EAF;" vertex="1" parent="1">
          <mxGeometry x="130" y="664" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-29" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="qxU7TaMwEPtlLGnzDzlK-24" target="qxU7TaMwEPtlLGnzDzlK-28">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-24" value="DP 16" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="130" y="119" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-25" value="TP 16" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="130" y="50" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-26" value="DP 16" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="130" y="778" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-31" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="qxU7TaMwEPtlLGnzDzlK-28" target="qxU7TaMwEPtlLGnzDzlK-30">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-28" value="q_a/kv_a" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#60a917;fontColor=#ffffff;strokeColor=#2D7600;" vertex="1" parent="1">
          <mxGeometry x="130" y="180" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-32" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="qxU7TaMwEPtlLGnzDzlK-30" target="pP14fSGPa2KV1FeZhE6j-2">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-30" value="all gather" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="130" y="240" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-60" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" source="qxU7TaMwEPtlLGnzDzlK-61" target="qxU7TaMwEPtlLGnzDzlK-65" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-61" value="attn tp16" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#1ba1e2;fontColor=#ffffff;strokeColor=#006EAF;" vertex="1" parent="1">
          <mxGeometry x="450" y="299" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-62" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" source="qxU7TaMwEPtlLGnzDzlK-63" target="qxU7TaMwEPtlLGnzDzlK-67" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-63" value="&lt;span style=&quot;color: rgb(255, 255, 255);&quot;&gt;o_proj&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#60a917;fontColor=#ffffff;strokeColor=#2D7600;" vertex="1" parent="1">
          <mxGeometry x="450" y="410" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-64" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" edge="1" source="qxU7TaMwEPtlLGnzDzlK-65" target="qxU7TaMwEPtlLGnzDzlK-63" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-65" value="all2all" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="450" y="350" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-66" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" source="qxU7TaMwEPtlLGnzDzlK-67" target="qxU7TaMwEPtlLGnzDzlK-70" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-67" value="add/rms norm&lt;div&gt;dynamic quant&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#60a917;fontColor=#ffffff;strokeColor=#2D7600;" vertex="1" parent="1">
          <mxGeometry x="450" y="468" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-68" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" source="qxU7TaMwEPtlLGnzDzlK-70" target="qxU7TaMwEPtlLGnzDzlK-72" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-69" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" source="qxU7TaMwEPtlLGnzDzlK-70" target="qxU7TaMwEPtlLGnzDzlK-74" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-70" value="all gather" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="450" y="527" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-71" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" source="qxU7TaMwEPtlLGnzDzlK-72" target="qxU7TaMwEPtlLGnzDzlK-78" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-72" value="mlp/attn/mlp tp16" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#1ba1e2;fontColor=#ffffff;strokeColor=#006EAF;" vertex="1" parent="1">
          <mxGeometry x="390" y="599" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-73" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" source="qxU7TaMwEPtlLGnzDzlK-74" target="qxU7TaMwEPtlLGnzDzlK-78" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="500" y="679" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-74" value="moe ep16" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="510" y="599" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-75" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" source="qxU7TaMwEPtlLGnzDzlK-76" target="qxU7TaMwEPtlLGnzDzlK-81" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-76" value="reduce_scatter" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="450" y="720" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-77" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" edge="1" source="qxU7TaMwEPtlLGnzDzlK-78" target="qxU7TaMwEPtlLGnzDzlK-76" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-78" value="add" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#1ba1e2;fontColor=#ffffff;strokeColor=#006EAF;" vertex="1" parent="1">
          <mxGeometry x="450" y="664" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-79" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" source="qxU7TaMwEPtlLGnzDzlK-80" target="qxU7TaMwEPtlLGnzDzlK-83" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-80" value="DP 16" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="450" y="119" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-81" value="DP 16" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="450" y="778" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-82" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" source="qxU7TaMwEPtlLGnzDzlK-83" target="qxU7TaMwEPtlLGnzDzlK-85" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-83" value="q_a/kv_a" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#60a917;fontColor=#ffffff;strokeColor=#2D7600;" vertex="1" parent="1">
          <mxGeometry x="450" y="180" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-84" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" source="qxU7TaMwEPtlLGnzDzlK-85" target="qxU7TaMwEPtlLGnzDzlK-61" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-85" value="all gather" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="450" y="240" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-86" value="TP 16" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="450" y="50" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-114" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" source="qxU7TaMwEPtlLGnzDzlK-115" target="qxU7TaMwEPtlLGnzDzlK-119" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-115" value="attn tp8" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#1ba1e2;fontColor=#ffffff;strokeColor=#006EAF;" vertex="1" parent="1">
          <mxGeometry x="-230" y="299" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-116" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" source="qxU7TaMwEPtlLGnzDzlK-117" target="qxU7TaMwEPtlLGnzDzlK-121" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-117" value="reduce_scatter tp8" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-230" y="410" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-118" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" edge="1" source="qxU7TaMwEPtlLGnzDzlK-119" target="qxU7TaMwEPtlLGnzDzlK-117" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-119" value="o_proj tp8" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#1ba1e2;fontColor=#ffffff;strokeColor=#006EAF;" vertex="1" parent="1">
          <mxGeometry x="-230" y="350" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-120" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" source="qxU7TaMwEPtlLGnzDzlK-121" target="qxU7TaMwEPtlLGnzDzlK-124" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-121" value="add/rms norm&lt;div&gt;dynamic quant&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#60a917;fontColor=#ffffff;strokeColor=#2D7600;" vertex="1" parent="1">
          <mxGeometry x="-230" y="468" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-122" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" source="qxU7TaMwEPtlLGnzDzlK-124" target="qxU7TaMwEPtlLGnzDzlK-126" parent="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="-180" y="580" />
              <mxPoint x="-240" y="580" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-145" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="qxU7TaMwEPtlLGnzDzlK-124" target="qxU7TaMwEPtlLGnzDzlK-144">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="-180" y="580" />
              <mxPoint x="-120" y="580" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-124" value="all gather tp8" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-230" y="527" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-141" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="qxU7TaMwEPtlLGnzDzlK-126" target="qxU7TaMwEPtlLGnzDzlK-132">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="-240" y="760" />
              <mxPoint x="-180" y="760" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-126" value="mlp/attn/mlp tp8" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#1ba1e2;fontColor=#ffffff;strokeColor=#006EAF;" vertex="1" parent="1">
          <mxGeometry x="-290" y="656" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-149" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="qxU7TaMwEPtlLGnzDzlK-128" target="qxU7TaMwEPtlLGnzDzlK-147">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-128" value="moe ep16" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-170" y="656" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-129" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" source="qxU7TaMwEPtlLGnzDzlK-130" target="qxU7TaMwEPtlLGnzDzlK-136" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-130" value="reduce_scatter&lt;div&gt;tp8&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-230" y="834" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-131" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" edge="1" source="qxU7TaMwEPtlLGnzDzlK-132" target="qxU7TaMwEPtlLGnzDzlK-130" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-132" value="add" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#1ba1e2;fontColor=#ffffff;strokeColor=#006EAF;" vertex="1" parent="1">
          <mxGeometry x="-230" y="778" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-133" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" source="qxU7TaMwEPtlLGnzDzlK-134" target="qxU7TaMwEPtlLGnzDzlK-138" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-134" value="DP 8 * 2" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-230" y="119" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-135" value="TP 8 * DP 2" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-230" y="50" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-136" value="DP 8 * 2" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-230" y="892" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-137" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" source="qxU7TaMwEPtlLGnzDzlK-138" target="qxU7TaMwEPtlLGnzDzlK-140" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-138" value="q_a/kv_a" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#60a917;fontColor=#ffffff;strokeColor=#2D7600;" vertex="1" parent="1">
          <mxGeometry x="-230" y="180" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-139" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" source="qxU7TaMwEPtlLGnzDzlK-140" target="qxU7TaMwEPtlLGnzDzlK-115" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-140" value="all gather tp 8" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-230" y="240" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-146" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="qxU7TaMwEPtlLGnzDzlK-144" target="qxU7TaMwEPtlLGnzDzlK-128">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-144" value="all gather tp2跨机" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-170" y="599" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-148" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="qxU7TaMwEPtlLGnzDzlK-147" target="qxU7TaMwEPtlLGnzDzlK-132">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-147" value="rs tp2跨机" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-170" y="710" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-150" value="routing在DP域进行，额外添加top_ids、weight的all gather" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=left;verticalAlign=top;rounded=0;fontSize=17;" vertex="1" parent="1">
          <mxGeometry x="-60" y="468" width="190" height="72" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-168" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" target="qxU7TaMwEPtlLGnzDzlK-170" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="-500" y="440" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-169" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" source="qxU7TaMwEPtlLGnzDzlK-170" target="qxU7TaMwEPtlLGnzDzlK-173" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-189" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="qxU7TaMwEPtlLGnzDzlK-170" target="qxU7TaMwEPtlLGnzDzlK-188">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-170" value="add/rms norm&lt;div&gt;dynamic quant&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#60a917;fontColor=#ffffff;strokeColor=#2D7600;" vertex="1" parent="1">
          <mxGeometry x="-550" y="468" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-171" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" source="qxU7TaMwEPtlLGnzDzlK-173" target="qxU7TaMwEPtlLGnzDzlK-175" parent="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="-500" y="580" />
              <mxPoint x="-560" y="580" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-173" value="all gather tp8" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-550" y="527" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-416" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="qxU7TaMwEPtlLGnzDzlK-175" target="qxU7TaMwEPtlLGnzDzlK-179">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-175" value="mlp/attn/mlp tp8" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#1ba1e2;fontColor=#ffffff;strokeColor=#006EAF;" vertex="1" parent="1">
          <mxGeometry x="-610" y="656" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-418" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="qxU7TaMwEPtlLGnzDzlK-179" target="qxU7TaMwEPtlLGnzDzlK-181">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-179" value="reduce_scatter&lt;div&gt;tp8&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-610" y="977" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-181" value="add" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#1ba1e2;fontColor=#ffffff;strokeColor=#006EAF;" vertex="1" parent="1">
          <mxGeometry x="-550" y="1057" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-182" value="DP 8 * 2" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-550" y="1110" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-364" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="qxU7TaMwEPtlLGnzDzlK-188" target="qxU7TaMwEPtlLGnzDzlK-190">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-188" value="init routing(512)" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-480" y="590" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-365" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="qxU7TaMwEPtlLGnzDzlK-190" target="qxU7TaMwEPtlLGnzDzlK-191">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-190" value="all2all(grouplist)" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-480" y="637" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-366" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="qxU7TaMwEPtlLGnzDzlK-191" target="qxU7TaMwEPtlLGnzDzlK-192">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-191" value="all2allv(x)" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-480" y="683" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-367" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="qxU7TaMwEPtlLGnzDzlK-192" target="qxU7TaMwEPtlLGnzDzlK-199">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-192" value="all2allv(pertoken)" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-480" y="730" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-369" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="qxU7TaMwEPtlLGnzDzlK-193" target="qxU7TaMwEPtlLGnzDzlK-200">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-193" value="ffn" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-480" y="830" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-371" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="qxU7TaMwEPtlLGnzDzlK-194" target="qxU7TaMwEPtlLGnzDzlK-195">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-194" value="all2allv(y)" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-480" y="930" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-419" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="qxU7TaMwEPtlLGnzDzlK-195" target="qxU7TaMwEPtlLGnzDzlK-181">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-195" value="finalize routing(y)" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-480" y="977" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-197" value="e1" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#60a917;fontColor=#ffffff;strokeColor=#2D7600;" vertex="1" parent="1">
          <mxGeometry x="-700" y="1310" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-368" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="qxU7TaMwEPtlLGnzDzlK-199" target="qxU7TaMwEPtlLGnzDzlK-193">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-199" value="rerouting" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-480" y="780" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-370" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="qxU7TaMwEPtlLGnzDzlK-200" target="qxU7TaMwEPtlLGnzDzlK-194">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-200" value="index_select&lt;div&gt;or rerouting&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-480" y="880" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-201" value="e2" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#60a917;fontColor=#ffffff;strokeColor=#2D7600;" vertex="1" parent="1">
          <mxGeometry x="-670" y="1310" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-204" value="e3" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#60a917;fontColor=#ffffff;strokeColor=#2D7600;" vertex="1" parent="1">
          <mxGeometry x="-640" y="1310" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-205" value="e4" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#60a917;fontColor=#ffffff;strokeColor=#2D7600;" vertex="1" parent="1">
          <mxGeometry x="-610" y="1310" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-206" value="e5" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#a20025;fontColor=#ffffff;strokeColor=#6F0000;" vertex="1" parent="1">
          <mxGeometry x="-580" y="1310" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-207" value="e6" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#a20025;fontColor=#ffffff;strokeColor=#6F0000;" vertex="1" parent="1">
          <mxGeometry x="-550" y="1310" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-208" value="e7" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#a20025;fontColor=#ffffff;strokeColor=#6F0000;" vertex="1" parent="1">
          <mxGeometry x="-520" y="1310" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-209" value="e8" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#a20025;fontColor=#ffffff;strokeColor=#6F0000;" vertex="1" parent="1">
          <mxGeometry x="-490" y="1310" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-242" value="e1" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#6d8764;fontColor=#ffffff;strokeColor=#3A5431;" vertex="1" parent="1">
          <mxGeometry x="-700" y="1390" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-243" value="e2" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#6d8764;fontColor=#ffffff;strokeColor=#3A5431;" vertex="1" parent="1">
          <mxGeometry x="-670" y="1390" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-244" value="e3" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#6d8764;fontColor=#ffffff;strokeColor=#3A5431;" vertex="1" parent="1">
          <mxGeometry x="-640" y="1390" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-245" value="e4" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#6d8764;fontColor=#ffffff;strokeColor=#3A5431;" vertex="1" parent="1">
          <mxGeometry x="-610" y="1390" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-246" value="e5" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#a0522d;fontColor=#ffffff;strokeColor=#6D1F00;" vertex="1" parent="1">
          <mxGeometry x="-580" y="1390" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-247" value="e6" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#a0522d;fontColor=#ffffff;strokeColor=#6D1F00;" vertex="1" parent="1">
          <mxGeometry x="-550" y="1390" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-248" value="e7" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#a0522d;fontColor=#ffffff;strokeColor=#6D1F00;" vertex="1" parent="1">
          <mxGeometry x="-520" y="1390" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-249" value="e8" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#a0522d;fontColor=#ffffff;strokeColor=#6D1F00;" vertex="1" parent="1">
          <mxGeometry x="-490" y="1390" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-259" value="e1" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#60a917;fontColor=#ffffff;strokeColor=#2D7600;" vertex="1" parent="1">
          <mxGeometry x="-310" y="1310" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-260" value="e2" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#60a917;fontColor=#ffffff;strokeColor=#2D7600;" vertex="1" parent="1">
          <mxGeometry x="-280" y="1310" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-261" value="e3" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#60a917;fontColor=#ffffff;strokeColor=#2D7600;" vertex="1" parent="1">
          <mxGeometry x="-250" y="1310" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-262" value="e4" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#60a917;fontColor=#ffffff;strokeColor=#2D7600;" vertex="1" parent="1">
          <mxGeometry x="-220" y="1310" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-263" value="e1" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#6d8764;fontColor=#ffffff;strokeColor=#3A5431;" vertex="1" parent="1">
          <mxGeometry x="-190" y="1310" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-264" value="e2" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#6d8764;fontColor=#ffffff;strokeColor=#3A5431;" vertex="1" parent="1">
          <mxGeometry x="-160" y="1310" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-265" value="e3" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#6d8764;fontColor=#ffffff;strokeColor=#3A5431;" vertex="1" parent="1">
          <mxGeometry x="-130" y="1310" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-266" value="e4" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#6d8764;fontColor=#ffffff;strokeColor=#3A5431;" vertex="1" parent="1">
          <mxGeometry x="-100" y="1310" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-267" value="e5" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#a20025;fontColor=#ffffff;strokeColor=#6F0000;" vertex="1" parent="1">
          <mxGeometry x="-310" y="1390" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-268" value="e6" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#a20025;fontColor=#ffffff;strokeColor=#6F0000;" vertex="1" parent="1">
          <mxGeometry x="-280" y="1390" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-269" value="e7" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#a20025;fontColor=#ffffff;strokeColor=#6F0000;" vertex="1" parent="1">
          <mxGeometry x="-250" y="1390" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-270" value="e8" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#a20025;fontColor=#ffffff;strokeColor=#6F0000;" vertex="1" parent="1">
          <mxGeometry x="-220" y="1390" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-271" value="e5" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#a0522d;fontColor=#ffffff;strokeColor=#6D1F00;" vertex="1" parent="1">
          <mxGeometry x="-190" y="1390" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-272" value="e6" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#a0522d;fontColor=#ffffff;strokeColor=#6D1F00;" vertex="1" parent="1">
          <mxGeometry x="-160" y="1390" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-273" value="e7" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#a0522d;fontColor=#ffffff;strokeColor=#6D1F00;" vertex="1" parent="1">
          <mxGeometry x="-130" y="1390" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-274" value="e8" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#a0522d;fontColor=#ffffff;strokeColor=#6D1F00;" vertex="1" parent="1">
          <mxGeometry x="-100" y="1390" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-275" value="all2all" style="shape=singleArrow;whiteSpace=wrap;html=1;arrowWidth=0.5142857142857262;arrowSize=0.32476190476190536;" vertex="1" parent="1">
          <mxGeometry x="-440" y="1330" width="100" height="60" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-276" value="dp grouplist" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="-630" y="1260" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-277" value="local grouplist" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="-250" y="1260" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-299" value="" style="endArrow=classic;html=1;rounded=0;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-570" y="1440" as="sourcePoint" />
            <mxPoint x="-420" y="1660" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-300" value="sum in ep as input_splits" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="qxU7TaMwEPtlLGnzDzlK-299">
          <mxGeometry x="-0.7739" y="-2" relative="1" as="geometry">
            <mxPoint x="1" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-301" value="" style="endArrow=classic;html=1;rounded=0;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-290" y="1440" as="sourcePoint" />
            <mxPoint x="-380" y="1660" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-302" value="sum in ep as output_splits" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="qxU7TaMwEPtlLGnzDzlK-301">
          <mxGeometry x="-0.7739" y="-2" relative="1" as="geometry">
            <mxPoint x="1" y="-6" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-329" value="" style="endArrow=classic;html=1;rounded=0;" edge="1" parent="1" target="qxU7TaMwEPtlLGnzDzlK-319">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-130" y="1430" as="sourcePoint" />
            <mxPoint x="20" y="1850" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-330" value="reshape [ep_size,-1]" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="qxU7TaMwEPtlLGnzDzlK-329">
          <mxGeometry x="-0.7739" y="-2" relative="1" as="geometry">
            <mxPoint x="1" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-210" value="e1" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#60a917;fontColor=#ffffff;strokeColor=#2D7600;" vertex="1" parent="1">
          <mxGeometry x="-700" y="1530" width="230" height="19.480519480519483" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-211" value="e2" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#60a917;fontColor=#ffffff;strokeColor=#2D7600;" vertex="1" parent="1">
          <mxGeometry x="-700" y="1549.4805194805194" width="230" height="7.792207792207793" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-212" value="e3" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#60a917;fontColor=#ffffff;strokeColor=#2D7600;" vertex="1" parent="1">
          <mxGeometry x="-700" y="1557.2727272727273" width="230" height="23.376623376623378" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-213" value="e4" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#60a917;fontColor=#ffffff;strokeColor=#2D7600;" vertex="1" parent="1">
          <mxGeometry x="-700" y="1580.6493506493507" width="230" height="19.480519480519483" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-214" value="e5" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#a20025;fontColor=#ffffff;strokeColor=#6F0000;" vertex="1" parent="1">
          <mxGeometry x="-700" y="1600.1298701298701" width="230" height="19.480519480519483" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-215" value="e6" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#a20025;fontColor=#ffffff;strokeColor=#6F0000;" vertex="1" parent="1">
          <mxGeometry x="-700" y="1619.6103896103896" width="230" height="11.688311688311689" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-216" value="e7" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#a20025;fontColor=#ffffff;strokeColor=#6F0000;" vertex="1" parent="1">
          <mxGeometry x="-700" y="1631.2987012987014" width="230" height="19.480519480519483" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-217" value="e8" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#a20025;fontColor=#ffffff;strokeColor=#6F0000;" vertex="1" parent="1">
          <mxGeometry x="-700" y="1650.7792207792209" width="230" height="11.688311688311689" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-234" value="e1" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#6d8764;fontColor=#ffffff;strokeColor=#3A5431;" vertex="1" parent="1">
          <mxGeometry x="-700" y="1697.5324675324675" width="230" height="19.480519480519483" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-235" value="e2" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#6d8764;fontColor=#ffffff;strokeColor=#3A5431;" vertex="1" parent="1">
          <mxGeometry x="-700" y="1717.012987012987" width="230" height="7.792207792207793" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-236" value="e3" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#6d8764;fontColor=#ffffff;strokeColor=#3A5431;" vertex="1" parent="1">
          <mxGeometry x="-700" y="1724.8051948051948" width="230" height="23.376623376623378" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-237" value="e4" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#6d8764;fontColor=#ffffff;strokeColor=#3A5431;" vertex="1" parent="1">
          <mxGeometry x="-700" y="1748.1818181818182" width="230" height="19.480519480519483" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-238" value="e5" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#a0522d;fontColor=#ffffff;strokeColor=#6D1F00;" vertex="1" parent="1">
          <mxGeometry x="-700" y="1767.6623376623377" width="230" height="19.480519480519483" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-239" value="e6" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#a0522d;fontColor=#ffffff;strokeColor=#6D1F00;" vertex="1" parent="1">
          <mxGeometry x="-700" y="1787.142857142857" width="230" height="11.688311688311689" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-240" value="e7" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#a0522d;fontColor=#ffffff;strokeColor=#6D1F00;" vertex="1" parent="1">
          <mxGeometry x="-700" y="1798.831168831169" width="230" height="19.480519480519483" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-241" value="e8" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#a0522d;fontColor=#ffffff;strokeColor=#6D1F00;" vertex="1" parent="1">
          <mxGeometry x="-700" y="1818.3116883116884" width="230" height="11.688311688311689" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-278" value="e1" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#60a917;fontColor=#ffffff;strokeColor=#2D7600;" vertex="1" parent="1">
          <mxGeometry x="-310" y="1530" width="230" height="19.480519480519483" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-279" value="e2" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#60a917;fontColor=#ffffff;strokeColor=#2D7600;" vertex="1" parent="1">
          <mxGeometry x="-310" y="1549.4805194805194" width="230" height="7.792207792207793" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-280" value="e3" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#60a917;fontColor=#ffffff;strokeColor=#2D7600;" vertex="1" parent="1">
          <mxGeometry x="-310" y="1557.2727272727273" width="230" height="23.376623376623378" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-281" value="e4" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#60a917;fontColor=#ffffff;strokeColor=#2D7600;" vertex="1" parent="1">
          <mxGeometry x="-310" y="1580.6493506493507" width="230" height="19.480519480519483" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-286" value="e1" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#6d8764;fontColor=#ffffff;strokeColor=#3A5431;" vertex="1" parent="1">
          <mxGeometry x="-310" y="1600.1298701298701" width="230" height="19.480519480519483" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-287" value="e2" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#6d8764;fontColor=#ffffff;strokeColor=#3A5431;" vertex="1" parent="1">
          <mxGeometry x="-310" y="1619.6103896103896" width="230" height="7.792207792207793" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-288" value="e3" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#6d8764;fontColor=#ffffff;strokeColor=#3A5431;" vertex="1" parent="1">
          <mxGeometry x="-310" y="1627.4025974025974" width="230" height="23.376623376623378" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-289" value="e4" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#6d8764;fontColor=#ffffff;strokeColor=#3A5431;" vertex="1" parent="1">
          <mxGeometry x="-310" y="1650.7792207792209" width="230" height="19.480519480519483" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-290" value="e5" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#a20025;fontColor=#ffffff;strokeColor=#6F0000;" vertex="1" parent="1">
          <mxGeometry x="-310" y="1697.5324675324675" width="230" height="19.480519480519483" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-291" value="e6" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#a20025;fontColor=#ffffff;strokeColor=#6F0000;" vertex="1" parent="1">
          <mxGeometry x="-310" y="1717.012987012987" width="230" height="11.688311688311689" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-292" value="e7" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#a20025;fontColor=#ffffff;strokeColor=#6F0000;" vertex="1" parent="1">
          <mxGeometry x="-310" y="1728.7012987012988" width="230" height="19.480519480519483" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-293" value="e8" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#a20025;fontColor=#ffffff;strokeColor=#6F0000;" vertex="1" parent="1">
          <mxGeometry x="-310" y="1748.1818181818182" width="230" height="11.688311688311689" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-294" value="e5" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#a0522d;fontColor=#ffffff;strokeColor=#6D1F00;" vertex="1" parent="1">
          <mxGeometry x="-310" y="1759.8701298701299" width="230" height="19.480519480519483" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-295" value="e6" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#a0522d;fontColor=#ffffff;strokeColor=#6D1F00;" vertex="1" parent="1">
          <mxGeometry x="-310" y="1779.3506493506493" width="230" height="11.688311688311689" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-296" value="e7" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#a0522d;fontColor=#ffffff;strokeColor=#6D1F00;" vertex="1" parent="1">
          <mxGeometry x="-310" y="1791.0389610389611" width="230" height="19.480519480519483" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-297" value="e8" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#a0522d;fontColor=#ffffff;strokeColor=#6D1F00;" vertex="1" parent="1">
          <mxGeometry x="-310" y="1810.5194805194806" width="230" height="11.688311688311689" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-298" value="all2allv" style="shape=singleArrow;whiteSpace=wrap;html=1;arrowWidth=0.5142857142857262;arrowSize=0.32476190476190536;" vertex="1" parent="1">
          <mxGeometry x="-440" y="1662.47" width="100" height="57.53" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-311" value="e1" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#60a917;fontColor=#ffffff;strokeColor=#2D7600;" vertex="1" parent="1">
          <mxGeometry x="65" y="1530" width="230" height="19.480519480519483" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-312" value="e1" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#6d8764;fontColor=#ffffff;strokeColor=#3A5431;" vertex="1" parent="1">
          <mxGeometry x="65" y="1549.4805194805194" width="230" height="19.480519480519483" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-313" value="e2" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#60a917;fontColor=#ffffff;strokeColor=#2D7600;" vertex="1" parent="1">
          <mxGeometry x="65" y="1568.9610389610389" width="230" height="7.792207792207793" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-314" value="e2" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#6d8764;fontColor=#ffffff;strokeColor=#3A5431;" vertex="1" parent="1">
          <mxGeometry x="65" y="1576.7532467532467" width="230" height="7.792207792207793" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-315" value="e3" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#60a917;fontColor=#ffffff;strokeColor=#2D7600;" vertex="1" parent="1">
          <mxGeometry x="65" y="1584.5454545454545" width="230" height="23.376623376623378" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-316" value="e3" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#6d8764;fontColor=#ffffff;strokeColor=#3A5431;" vertex="1" parent="1">
          <mxGeometry x="65" y="1607.922077922078" width="230" height="23.376623376623378" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-317" value="e4" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#60a917;fontColor=#ffffff;strokeColor=#2D7600;" vertex="1" parent="1">
          <mxGeometry x="65" y="1631.2987012987014" width="230" height="19.480519480519483" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-318" value="e4" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#6d8764;fontColor=#ffffff;strokeColor=#3A5431;" vertex="1" parent="1">
          <mxGeometry x="65" y="1650.7792207792209" width="230" height="19.480519480519483" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-319" value="re_routing" style="shape=singleArrow;whiteSpace=wrap;html=1;arrowWidth=0.5142857142857262;arrowSize=0.32476190476190536;" vertex="1" parent="1">
          <mxGeometry x="-60" y="1576.75" width="100" height="51.56" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-320" value="e5" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#a20025;fontColor=#ffffff;strokeColor=#6F0000;" vertex="1" parent="1">
          <mxGeometry x="65" y="1697.5324675324675" width="230" height="19.480519480519483" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-321" value="e5" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#a0522d;fontColor=#ffffff;strokeColor=#6D1F00;" vertex="1" parent="1">
          <mxGeometry x="65" y="1717.012987012987" width="230" height="19.480519480519483" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-322" value="e6" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#a20025;fontColor=#ffffff;strokeColor=#6F0000;" vertex="1" parent="1">
          <mxGeometry x="65" y="1736.4935064935066" width="230" height="11.688311688311689" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-323" value="e6" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#a0522d;fontColor=#ffffff;strokeColor=#6D1F00;" vertex="1" parent="1">
          <mxGeometry x="65" y="1748.1818181818182" width="230" height="11.688311688311689" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-324" value="e7" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#a20025;fontColor=#ffffff;strokeColor=#6F0000;" vertex="1" parent="1">
          <mxGeometry x="65" y="1759.8701298701299" width="230" height="19.480519480519483" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-325" value="e7" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#a0522d;fontColor=#ffffff;strokeColor=#6D1F00;" vertex="1" parent="1">
          <mxGeometry x="65" y="1779.3506493506493" width="230" height="19.480519480519483" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-326" value="e8" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#a20025;fontColor=#ffffff;strokeColor=#6F0000;" vertex="1" parent="1">
          <mxGeometry x="65" y="1798.831168831169" width="230" height="11.688311688311689" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-327" value="e8" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#a0522d;fontColor=#ffffff;strokeColor=#6D1F00;" vertex="1" parent="1">
          <mxGeometry x="65" y="1810.5194805194806" width="230" height="11.688311688311689" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-333" value="re_routing" style="shape=singleArrow;whiteSpace=wrap;html=1;arrowWidth=0.5142857142857262;arrowSize=0.32476190476190536;" vertex="1" parent="1">
          <mxGeometry x="-60" y="1739.48" width="100" height="51.56" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-334" value="npu0" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="-790" y="1309.09" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-335" value="npu1" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="-790" y="1389.09" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-336" value="npu0" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="-790" y="1579.09" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-337" value="npu1" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="-790" y="1749.35" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-338" value="e1" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#60a917;fontColor=#ffffff;strokeColor=#2D7600;" vertex="1" parent="1">
          <mxGeometry x="70" y="1348.18" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-339" value="e2" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#60a917;fontColor=#ffffff;strokeColor=#2D7600;" vertex="1" parent="1">
          <mxGeometry x="100" y="1348.18" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-340" value="e3" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#60a917;fontColor=#ffffff;strokeColor=#2D7600;" vertex="1" parent="1">
          <mxGeometry x="130" y="1348.18" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-341" value="e4" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#60a917;fontColor=#ffffff;strokeColor=#2D7600;" vertex="1" parent="1">
          <mxGeometry x="160" y="1348.18" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-342" value="e1" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#6d8764;fontColor=#ffffff;strokeColor=#3A5431;" vertex="1" parent="1">
          <mxGeometry x="70" y="1379.0900000000001" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-343" value="e2" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#6d8764;fontColor=#ffffff;strokeColor=#3A5431;" vertex="1" parent="1">
          <mxGeometry x="100" y="1379.0900000000001" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-344" value="e3" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#6d8764;fontColor=#ffffff;strokeColor=#3A5431;" vertex="1" parent="1">
          <mxGeometry x="130" y="1379.0900000000001" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-345" value="e4" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#6d8764;fontColor=#ffffff;strokeColor=#3A5431;" vertex="1" parent="1">
          <mxGeometry x="160" y="1379.0900000000001" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-346" value="e1" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#60a917;fontColor=#ffffff;strokeColor=#2D7600;" vertex="1" parent="1">
          <mxGeometry x="245" y="1348.18" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-347" value="e1" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#6d8764;fontColor=#ffffff;strokeColor=#3A5431;" vertex="1" parent="1">
          <mxGeometry x="275" y="1348.18" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-348" value="e2" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#60a917;fontColor=#ffffff;strokeColor=#2D7600;" vertex="1" parent="1">
          <mxGeometry x="245" y="1378.18" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-349" value="e2" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#6d8764;fontColor=#ffffff;strokeColor=#3A5431;" vertex="1" parent="1">
          <mxGeometry x="275" y="1378.18" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-350" value="e3" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#60a917;fontColor=#ffffff;strokeColor=#2D7600;" vertex="1" parent="1">
          <mxGeometry x="245" y="1409.0900000000001" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-351" value="e4" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#60a917;fontColor=#ffffff;strokeColor=#2D7600;" vertex="1" parent="1">
          <mxGeometry x="245" y="1439.0900000000001" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-352" value="e4" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#6d8764;fontColor=#ffffff;strokeColor=#3A5431;" vertex="1" parent="1">
          <mxGeometry x="275" y="1439.0900000000001" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-353" value="e3" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#6d8764;fontColor=#ffffff;strokeColor=#3A5431;" vertex="1" parent="1">
          <mxGeometry x="275" y="1409.0900000000001" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-355" value="ep size" style="shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;labelPosition=left;verticalLabelPosition=middle;align=right;verticalAlign=middle;" vertex="1" parent="1">
          <mxGeometry x="40" y="1348.0900000000001" width="20" height="61" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-356" value="" style="shape=singleArrow;whiteSpace=wrap;html=1;arrowWidth=0.5060606060606082;arrowSize=0.6030303030303119;" vertex="1" parent="1">
          <mxGeometry x="205" y="1395" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-357" value="" style="endArrow=classic;html=1;rounded=0;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="100" y="1330" as="sourcePoint" />
            <mxPoint x="170" y="1330" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-358" value="" style="endArrow=classic;html=1;rounded=0;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="245" y="1330" as="sourcePoint" />
            <mxPoint x="300" y="1330" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-359" value="ffn" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="130" y="1900" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-360" value="" style="endArrow=classic;html=1;rounded=0;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="179.55" y="1840" as="sourcePoint" />
            <mxPoint x="179.55" y="1890" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-361" value="re_routing" style="shape=singleArrow;whiteSpace=wrap;html=1;arrowWidth=0.5142857142857262;arrowSize=0.32476190476190536;direction=west;" vertex="1" parent="1">
          <mxGeometry x="-60" y="1889.22" width="100" height="51.56" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-362" value="all2allv" style="shape=singleArrow;whiteSpace=wrap;html=1;arrowWidth=0.5142857142857262;arrowSize=0.32476190476190536;direction=west;" vertex="1" parent="1">
          <mxGeometry x="-430" y="1886.24" width="100" height="57.53" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-363" value="finalize routing(y)" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-800" y="1900" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-373" value="mlp/attn/mlp tp8" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#1ba1e2;fontColor=#ffffff;strokeColor=#006EAF;" vertex="1" parent="1">
          <mxGeometry x="350" y="947" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-374" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" source="qxU7TaMwEPtlLGnzDzlK-375" target="qxU7TaMwEPtlLGnzDzlK-379" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-375" value="attn tp16" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#1ba1e2;fontColor=#ffffff;strokeColor=#006EAF;" vertex="1" parent="1">
          <mxGeometry x="520" y="1148" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-376" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" source="qxU7TaMwEPtlLGnzDzlK-377" target="qxU7TaMwEPtlLGnzDzlK-380" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-377" value="&lt;span style=&quot;color: rgb(255, 255, 255);&quot;&gt;o_proj&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#60a917;fontColor=#ffffff;strokeColor=#2D7600;" vertex="1" parent="1">
          <mxGeometry x="520" y="1251" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-378" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" edge="1" source="qxU7TaMwEPtlLGnzDzlK-379" target="qxU7TaMwEPtlLGnzDzlK-377" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-379" value="all2all" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="520" y="1199" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-408" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="qxU7TaMwEPtlLGnzDzlK-380" target="qxU7TaMwEPtlLGnzDzlK-400">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-380" value="add/rms norm&lt;div&gt;dynamic quant&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#60a917;fontColor=#ffffff;strokeColor=#2D7600;" vertex="1" parent="1">
          <mxGeometry x="520" y="1302" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-381" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" source="qxU7TaMwEPtlLGnzDzlK-382" target="qxU7TaMwEPtlLGnzDzlK-384" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-382" value="q_a/kv_a" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#60a917;fontColor=#ffffff;strokeColor=#2D7600;" vertex="1" parent="1">
          <mxGeometry x="520" y="1045" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-383" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" source="qxU7TaMwEPtlLGnzDzlK-384" target="qxU7TaMwEPtlLGnzDzlK-375" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-384" value="all gather" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="520" y="1096" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-386" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="qxU7TaMwEPtlLGnzDzlK-385" target="qxU7TaMwEPtlLGnzDzlK-373">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-385" value="all gather" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="350" y="890" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-414" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="qxU7TaMwEPtlLGnzDzlK-387" target="qxU7TaMwEPtlLGnzDzlK-389">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-387" value="all gather" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="520" y="890" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-413" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="qxU7TaMwEPtlLGnzDzlK-389" target="qxU7TaMwEPtlLGnzDzlK-396">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-389" value="ffn" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="520" y="942" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-398" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="qxU7TaMwEPtlLGnzDzlK-396" target="qxU7TaMwEPtlLGnzDzlK-382">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-396" value="reduce_scatter" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="520" y="993" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-411" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="qxU7TaMwEPtlLGnzDzlK-400" target="qxU7TaMwEPtlLGnzDzlK-404">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-400" value="all gather" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="520" y="1354" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-412" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="qxU7TaMwEPtlLGnzDzlK-404" target="qxU7TaMwEPtlLGnzDzlK-407">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-404" value="ffn" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="520" y="1405" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-407" value="reduce_scatter" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="520" y="1457" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-409" value="dense tp&amp;gt;1" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="520" y="850" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-415" value="dense tp==ep时才能合并rs" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=left;verticalAlign=top;rounded=0;fontSize=17;" vertex="1" parent="1">
          <mxGeometry x="-120" y="815" width="113" height="49" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-420" value="与前面ag的通信域相同，可以不考虑attn tp size，如果dense没有tp，可以去掉通信算子" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=left;verticalAlign=top;rounded=0;fontSize=17;" vertex="1" parent="1">
          <mxGeometry x="-720" y="852" width="140" height="110" as="geometry" />
        </mxCell>
        <mxCell id="qxU7TaMwEPtlLGnzDzlK-421" value="DP 8*2" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="-530" y="1007" width="60" height="30" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
